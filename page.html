<!DOCTYPE html>
<html>
<head><title>Simple Chat</title></head>
<body>
  <h2>Chat Room</h2>

  <input type="text" id="nama" placeholder="Nama"><br>
  <input type="text" id="pesan" placeholder="Tulis pesan"><br>
  <button onclick="kirim()">Kirim</button>

  <h3>Riwayat Chat:</h3>
  <div id="chatlog"></div>

  <script>
    const apiURL = "https://yanshs.rf.gd/api.php"; 
    function kirim() {
      const nama = document.getElementById("nama").value;
      const pesan = document.getElementById("pesan").value;
      if (!nama || !pesan) return alert("Isi dulu");

      fetch(apiURL, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({nama, pesan})
      }).then(() => {
        document.getElementById("pesan").value = "";
        ambilChat();
      });
    }

    function ambilChat() {
      fetch(apiURL)
        .then(res => res.json())
        .then(data => {
          let isi = "";
          data.forEach(d => {
            isi += `<p><b>${d.nama}:</b> ${d.pesan} <small>(${d.waktu})</small></p>`;
          });
          document.getElementById("chatlog").innerHTML = isi;
        });
    }

    setInterval(ambilChat, 2000);  
    ambilChat();
  </script>
</body>
</html>
